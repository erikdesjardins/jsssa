---
created: "2019-03-14T22:42:34.859453800Z"
creator: insta@0.7.1
source: src/tests/ast2ir.rs
expression: "ast.map(ast2ir::convert)"
---
Ok(
    Block {
        children: [
            Expr(
                Ref(32 'fn_'),
                Function(
                    Func {
                        is_async: false,
                        is_generator: false
                    },
                    Some(
                        Atom('f' type=inline)
                    ),
                    [
                        Ref(1 'x')
                    ],
                    Block {
                        children: [
                            Expr(
                                Ref(31 'curfn_'),
                                CurrentFunction
                            ),
                            WriteBinding(
                                Ref(2 'f'),
                                Ref(31 'curfn_')
                            ),
                            Loop(
                                Block {
                                    children: [
                                        Expr(
                                            Ref(3 'while_'),
                                            Bool(
                                                true
                                            )
                                        ),
                                        IfElse(
                                            Ref(3 'while_'),
                                            Block {
                                                children: []
                                            },
                                            Block {
                                                children: [
                                                    Break
                                                ]
                                            }
                                        )
                                    ]
                                }
                            ),
                            Expr(
                                Ref(5 'obj_'),
                                ReadGlobal(
                                    Atom('y' type=inline)
                                )
                            ),
                            Expr(
                                Ref(6 'prop_'),
                                ReadGlobal(
                                    Atom('bar' type=inline)
                                )
                            ),
                            Expr(
                                Ref(4 'val_'),
                                ReadMember(
                                    Ref(5 'obj_'),
                                    Ref(6 'prop_')
                                )
                            ),
                            WriteBinding(
                                Ref(1 'x'),
                                Ref(4 'val_')
                            ),
                            Expr(
                                Ref(<dead>),
                                Read(
                                    Ref(4 'val_')
                                )
                            ),
                            Expr(
                                Ref(8 'obj_'),
                                ReadGlobal(
                                    Atom('z' type=inline)
                                )
                            ),
                            Expr(
                                Ref(9 'prop_'),
                                ReadGlobal(
                                    Atom('foo' type=inline)
                                )
                            ),
                            Expr(
                                Ref(10 'test_'),
                                ReadBinding(
                                    Ref(1 'x')
                                )
                            ),
                            Expr(
                                Ref(11 'undef_'),
                                Undefined
                            ),
                            WriteBinding(
                                Ref(12 'value_'),
                                Ref(11 'undef_')
                            ),
                            IfElse(
                                Ref(10 'test_'),
                                Block {
                                    children: [
                                        Expr(
                                            Ref(13 'alt_'),
                                            String(
                                                Atom('hi' type=inline)
                                            )
                                        ),
                                        WriteBinding(
                                            Ref(12 'value_'),
                                            Ref(13 'alt_')
                                        )
                                    ]
                                },
                                Block {
                                    children: [
                                        Expr(
                                            Ref(14 'cons_'),
                                            Bool(
                                                true
                                            )
                                        ),
                                        WriteBinding(
                                            Ref(12 'value_'),
                                            Ref(14 'cons_')
                                        )
                                    ]
                                }
                            ),
                            Expr(
                                Ref(7 'val_'),
                                ReadBinding(
                                    Ref(12 'value_')
                                )
                            ),
                            WriteMember(
                                Ref(8 'obj_'),
                                Ref(9 'prop_'),
                                Ref(7 'val_')
                            ),
                            Expr(
                                Ref(<dead>),
                                Read(
                                    Ref(7 'val_')
                                )
                            ),
                            Expr(
                                Ref(18 'pred_'),
                                Number(
                                    1.0
                                )
                            ),
                            WriteBinding(
                                Ref(19 'logi_'),
                                Ref(18 'pred_')
                            ),
                            IfElse(
                                Ref(18 'pred_'),
                                Block {
                                    children: []
                                },
                                Block {
                                    children: [
                                        Expr(
                                            Ref(20 'cons_'),
                                            ReadBinding(
                                                Ref(1 'x')
                                            )
                                        ),
                                        WriteBinding(
                                            Ref(19 'logi_'),
                                            Ref(20 'cons_')
                                        )
                                    ]
                                }
                            ),
                            Expr(
                                Ref(17 'ele_'),
                                ReadBinding(
                                    Ref(19 'logi_')
                                )
                            ),
                            Expr(
                                Ref(22 'key_'),
                                String(
                                    Atom('x' type=inline)
                                )
                            ),
                            Expr(
                                Ref(23 'value_'),
                                ReadBinding(
                                    Ref(1 'x')
                                )
                            ),
                            Expr(
                                Ref(21 'ele_'),
                                Object(
                                    [
                                        (
                                            Simple,
                                            Ref(22 'key_'),
                                            Ref(23 'value_')
                                        )
                                    ]
                                )
                            ),
                            Expr(
                                Ref(25 'left_'),
                                ReadBinding(
                                    Ref(2 'f')
                                )
                            ),
                            Expr(
                                Ref(26 'right_'),
                                Number(
                                    1.0
                                )
                            ),
                            Expr(
                                Ref(24 'ele_'),
                                Binary(
                                    Add,
                                    Ref(25 'left_'),
                                    Ref(26 'right_')
                                )
                            ),
                            Expr(
                                Ref(29 'read_'),
                                ReadGlobal(
                                    Atom('g' type=inline)
                                )
                            ),
                            Expr(
                                Ref(28 'one_'),
                                Number(
                                    1.0
                                )
                            ),
                            Expr(
                                Ref(30 'write_'),
                                Binary(
                                    Add,
                                    Ref(29 'read_'),
                                    Ref(28 'one_')
                                )
                            ),
                            WriteGlobal(
                                Atom('g' type=inline),
                                Ref(30 'write_')
                            ),
                            Expr(
                                Ref(27 'ele_'),
                                Read(
                                    Ref(30 'write_')
                                )
                            ),
                            Expr(
                                Ref(16 'unary_'),
                                Array(
                                    [
                                        Some(
                                            (
                                                Single,
                                                Ref(17 'ele_')
                                            )
                                        ),
                                        Some(
                                            (
                                                Single,
                                                Ref(21 'ele_')
                                            )
                                        ),
                                        Some(
                                            (
                                                Single,
                                                Ref(24 'ele_')
                                            )
                                        ),
                                        Some(
                                            (
                                                Single,
                                                Ref(27 'ele_')
                                            )
                                        )
                                    ]
                                )
                            ),
                            Expr(
                                Ref(15 'return_'),
                                Unary(
                                    Plus,
                                    Ref(16 'unary_')
                                )
                            ),
                            Return(
                                Ref(15 'return_')
                            )
                        ]
                    }
                )
            ),
            WriteBinding(
                Ref(33 'f'),
                Ref(32 'fn_')
            ),
            Expr(
                Ref(34 'fn_'),
                ReadGlobal(
                    Atom('f' type=inline)
                )
            ),
            Expr(
                Ref(35 'arg_'),
                Number(
                    1.0
                )
            ),
            Expr(
                Ref(<dead>),
                Call(
                    Call,
                    Ref(34 'fn_'),
                    [
                        (
                            Single,
                            Ref(35 'arg_')
                        )
                    ]
                )
            ),
            Expr(
                Ref(<dead>),
                Bool(
                    true
                )
            )
        ]
    }
)
